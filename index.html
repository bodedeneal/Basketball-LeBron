<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Basketball Scoreboard Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background: #222;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      margin-top: 20px;
      font-size: 2.5em;
      font-weight: bold;
      text-shadow: 2px 2px 10px #000;
    }
    .scoreboard {
      display: flex;
      justify-content: center;
      gap: 60px;
      margin: 30px 0;
    }
    .player {
      background: #333;
      padding: 30px 40px;
      border-radius: 20px;
      box-shadow: 0 0 20px #444;
      text-align: center;
      min-width: 180px;
    }
    .player.active {
      border: 3px solid #FFA500;
      box-shadow: 0 0 30px #FFA500;
    }
    .score {
      font-size: 3em;
      font-weight: bold;
      margin: 10px 0;
    }
    .controls {
      display: flex;
      gap: 20px;
      margin-bottom: 25px;
    }
    .controls button {
      padding: 12px 26px;
      font-size: 1.1em;
      border-radius: 10px;
      border: none;
      background: #FFA500;
      color: #222;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 2px 8px #000;
      transition: background 0.2s;
    }
    .controls button:active {
      background: #cc8500;
    }
    #video {
      border-radius: 18px;
      box-shadow: 0 0 40px #000;
      width: 640px;
      max-width: 95vw;
      margin-bottom: 20px;
    }
    #status {
      margin-bottom: 16px;
      font-size: 1.1em;
      color: #FFA500;
      text-shadow: 1px 2px 8px #000;
    }
    @media (max-width: 700px) {
      #video { width: 98vw; }
      .scoreboard { gap: 10vw; }
      .player { padding: 18px 5vw; }
    }
  </style>
</head>
<body>
  <h1>üèÄ Basketball Scoreboard Hub</h1>
  <div class="scoreboard">
    <div id="player1" class="player active">
      <div>Player 1</div>
      <div class="score" id="score1">0</div>
      <div id="possession1" style="font-size:1em;"></div>
    </div>
    <div id="player2" class="player">
      <div>Player 2</div>
      <div class="score" id="score2">0</div>
      <div id="possession2" style="font-size:1em;"></div>
    </div>
  </div>
  <div class="controls">
    <button onclick="switchPossession()">Switch Possession</button>
    <button onclick="addPoint()">Add Point</button>
  </div>
  <div id="status">Initializing camera...</div>
  <video id="video" autoplay playsinline></video>
  <canvas id="canvas" width="640" height="480" style="display:none;"></canvas>

  <script>
    let score = [0, 0];
    let possession = 0; // 0: Player 1, 1: Player 2
    let lastBallDetected = false;
    let lastPointTime = 0;

    function updateUI() {
      document.getElementById('score1').textContent = score[0];
      document.getElementById('score2').textContent = score[1];
      document.getElementById('player1').classList.toggle('active', possession === 0);
      document.getElementById('player2').classList.toggle('active', possession === 1);
      document.getElementById('possession1').textContent = possession === 0 ? 'üèÄ Has Ball' : '';
      document.getElementById('possession2').textContent = possession === 1 ? 'üèÄ Has Ball' : '';
    }

    function switchPossession() {
      possession = 1 - possession;
      updateUI();
      document.getElementById('status').textContent = `Possession switched to Player ${possession+1}`;
    }

    function addPoint() {
      score[possession]++;
      updateUI();
      document.getElementById('status').textContent = `Point added to Player ${possession+1}`;
    }

    // Camera setup
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        video.srcObject = stream;
        video.onloadedmetadata = () => {
          document.getElementById('status').textContent = "Camera ready. Looking for orange ball...";
          processFrame();
        };
      })
      .catch(err => {
        document.getElementById('status').textContent = "Camera access denied.";
        console.error("Camera error:", err);
      });

    // Orange ball detection (simple color detection)
    function processFrame() {
      if (video.readyState === video.HAVE_ENOUGH_DATA) {
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        let imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        let orangePixels = 0;
        let totalPixels = imgData.data.length / 4;
        for (let i = 0; i < imgData.data.length; i += 4) {
          let r = imgData.data[i], g = imgData.data[i+1], b = imgData.data[i+2];
          // Basic orange detection in RGB
          if (r > 180 && g > 80 && g < 170 && b < 70) {
            orangePixels++;
          }
        }
        let orangeRatio = orangePixels / totalPixels;
        let detected = orangeRatio > 0.03; // Tune this threshold for your ball/lighting

        // Only trigger point if ball appears (simulate hoop detection by waving ball in view)
        let now = Date.now();
        if (detected && !lastBallDetected && now - lastPointTime > 2000) {
          score[possession]++;
          updateUI();
          lastPointTime = now;
          document.getElementById('status').textContent = `Orange ball detected! Point for Player ${possession+1}`;
        }
        lastBallDetected = detected;
      }
      requestAnimationFrame(processFrame);
    }

    updateUI();
  </script>
</body>
</html>
